<!DOCTYPE html>
<html>
<head>
    <title>Photon Property Converter</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            color-scheme: light dark;
            --bg-color: light-dark(#f0f4f8, #1a1a1a);
            --container-bg: light-dark(#ffffff, #2c2c2c);
            --text-color: light-dark(#333333, #e0e0e0);
            --input-bg: light-dark(#ffffff, #3a3a3a);
            --input-border: light-dark(#cccccc, #555555);
            --button-bg: light-dark(#4a90e2, #357abd);
            --button-color: #ffffff;
            --button-hover: light-dark(#357abd, #4a90e2);
            --shadow: light-dark(rgba(0, 0, 0, 0.2), rgba(255, 255, 255, 0.2));
            --container-width: 460px;
        }
        body {
            font-family: Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            height:auto;
            min-width: var(--container-width);
            flex-direction: column;
            /* box-sizing: border-box; */
        }
        .container {
            background-color: var(--container-bg);
            border-radius: 10px;
            box-shadow: 0.3rem 0.3rem 8px var(--shadow);
            padding: 20px;
            width: var(--container-width);
            margin-bottom: 20px;
            /* display:inline; */
            text-align: left;
        }
        h1 {
            font-size: 30px;
            margin-bottom: 20px;
            margin-top: 0px;
        }
        h2 {
            font-size: 24px;
            margin-bottom: 20px;
            margin-top: 0px;
            font-weight: 100;

        }
        input[type="number"] {
            width: 130px;
            padding: 3px;
            margin-bottom: 20px;
            border: 1px solid var(--input-border);
            background-color: var(--input-bg);
            color: var(--text-color);
            border-radius: 5px;
        }
        button {
            background-color: var(--button-bg);
            color: var(--button-color);
            border: none;
            padding: 3px 10px;
            border-radius: 5px;
            cursor: pointer;
            /* font-size: 12px; */
        }
        button:hover {
            background-color: var(--button-hover);
        }
        /* #result {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        } */
        label, #inputType, #inputBandwidthType, #inputMinCenterMaxType, #inputMinCenterMax {
            width: 180px; /* Adjust the value to your desired width */
            display: inline-flex;
        }
        span {
            width: 130px; /* Adjust the value to your desired width */
            padding: 3px;
            display: inline-flex;
            text-overflow: ellipsis; /* Adds ellipsis (...) for long text */
            height: 12px;
        }
        select {
            width: 60px; /* Adjust the value to your desired width */
            display: inline-flex;
            background-color: var(--input-bg);
            color: var(--text-color);
            border: 1px solid var(--input-border);
            padding: 3px;
            border-radius: 5px;
        }
    </style>
    <script>
        const displayedSignificantDigits = 8;
        const c = 299792458; // Speed of light in m/s
        const h = 4.135667696E-15; // Planck's constant in eV/Hz
        const h_bar = 6.5821220E-16; // h bar in eV/Hz
        const hc = h*c;
        const refractiveIndexData = {
            wavelengthVacuumNanometers: [230, 244.6, 259.2, 273.8, 288.4, 303, 317.6, 332.2, 346.8, 361.4, 376, 390.6, 405.2, 419.8, 434.4, 449, 463.6, 478.2, 492.8, 507.4, 522, 536.6, 551.2, 565.8, 580.4, 595, 609.6, 624.2, 638.8, 653.4, 668, 682.6, 697.2, 711.8, 726.4, 741, 755.6, 770.2, 784.8, 799.4, 814, 828.6, 843.2, 857.8, 872.4, 887, 901.6, 916.2, 930.8, 945.4, 960, 974.6, 989.2, 1004, 1018, 1033, 1048, 1062, 1077, 1091, 1106, 1121, 1135, 1150, 1164, 1179, 1194, 1208, 1223, 1237, 1252, 1267, 1281, 1296, 1310, 1325, 1340, 1354, 1369, 1383, 1398, 1413, 1427, 1442, 1456, 1471, 1486, 1500, 1515, 1529, 1544, 1559, 1573, 1588, 1602, 1617, 1632, 1646, 1661, 1675, 1690],
            wavelengthAirNanometers: [229.929181, 244.5259, 259.122494, 273.718996, 288.315429, 302.911807, 317.508141, 332.104439, 346.700708, 361.296952, 375.893175, 390.489379, 405.085568, 419.681743, 434.277907, 448.874059, 463.470202, 478.066337, 492.662464, 507.258585, 521.854699, 536.450808, 551.046911, 565.64301, 580.239105, 594.835196, 609.431283, 624.027367, 638.623447, 653.219525, 667.815601, 682.411673, 697.007744, 711.603812, 726.199879, 740.795943, 755.392006, 769.988067, 784.584126, 799.180185, 813.776241, 828.372296, 842.968351, 857.564403, 872.160455, 886.756506, 901.352555, 915.948604, 930.544652, 945.140699, 959.736745, 974.33279, 988.928836, 1003.724825, 1017.721031, 1032.716965, 1047.712898, 1061.709102, 1076.705036, 1090.701238, 1105.697169, 1120.6931, 1134.689302, 1149.685231, 1163.681432, 1178.677361, 1193.673289, 1207.669489, 1222.665416, 1236.661616, 1251.657543, 1266.653469, 1280.649667, 1295.645593, 1309.641789, 1324.637716, 1339.63364, 1353.629836, 1368.62576, 1382.621957, 1397.61788, 1412.613804, 1426.609999, 1441.605923, 1455.602117, 1470.59804, 1485.593962, 1499.590156, 1514.586079, 1528.582272, 1543.578194, 1558.574115, 1572.570308, 1587.566229, 1601.562423, 1616.558343, 1631.554264, 1645.550455, 1660.546377, 1674.542569, 1689.538489],
            frequencyTeraHertz: [1303.44547, 1225.643737, 1156.606705, 1094.932279, 1039.502282, 989.4140528, 943.9309131, 902.4456893, 864.4534544, 829.5308744, 797.320367, 767.5178136, 739.8629269, 714.1316293, 690.1299678, 667.689216, 646.6619025, 626.9185655, 608.3450852, 590.8404769, 574.3150536, 558.6888893, 543.8905261, 529.8558819, 516.5273225, 503.8528706, 491.7855282, 480.2826946, 469.3056637, 458.8191889, 448.7911048, 439.1919982, 429.9949197, 421.1751307, 412.7098816, 404.5782159, 396.7607967, 389.2397533, 381.9985449, 375.0218389, 368.2954029, 361.8060077, 355.5413401, 349.4899254, 343.6410569, 337.9847328, 332.5115994, 327.2128989, 322.0804233, 317.1064713, 312.2838104, 307.6056413, 303.0655661, 298.5980657, 294.491609, 290.2153514, 286.0615057, 282.2904501, 278.3588282, 274.7868543, 271.0600886, 267.433058, 264.1343242, 260.6890939, 257.5536581, 254.276894, 251.0824606, 248.1725646, 245.1287473, 242.3544527, 239.450845, 236.615989, 234.0300219, 231.321341, 228.8492046, 226.2584589, 223.7257149, 221.4124505, 218.9864558, 216.7696732, 214.4438183, 212.1673447, 210.085815, 207.9004563, 205.9014135, 203.8018069, 201.7445882, 199.8616387, 197.8828106, 196.0709339, 194.1660997, 192.2979205, 190.5864323, 188.7861826, 187.1363658, 185.4004069, 183.6963591, 182.1339356, 180.4891379, 178.9805719, 177.391987],
            energyElectronVolt: [5.390617323, 5.06885521, 4.783340989, 4.528276057, 4.299036007, 4.091887737, 3.903784585, 3.732215486, 3.575092227, 3.430664041, 3.297452086, 3.174198629, 3.059827207, 2.953411111, 2.854148214, 2.761340722, 2.674378741, 2.59272686, 2.515913118, 2.443519875, 2.375176215, 2.310551592, 2.24935048, 2.191307855, 2.136185362, 2.083768041, 2.033861523, 1.986289626, 1.940892274, 1.897523698, 1.856050875, 1.81635216, 1.778316099, 1.741840383, 1.706830926, 1.673201058, 1.64087081, 1.609766274, 1.579819042, 1.550965705, 1.523147401, 1.496309419, 1.470400835, 1.445374195, 1.421185218, 1.397792542, 1.37515748, 1.353243816, 1.332017602, 1.31144699, 1.291502067, 1.272154714, 1.253378472, 1.234902375, 1.217919435, 1.200234254, 1.183055329, 1.167459496, 1.151199614, 1.136427117, 1.121014452, 1.106014259, 1.092371792, 1.078123465, 1.065156344, 1.051604736, 1.038393622, 1.026359259, 1.013771042, 1.002297481, 0.990289125, 0.978565102, 0.967870402, 0.956668198, 0.946444263, 0.935729799, 0.925255212, 0.915688319, 0.905655211, 0.896487335, 0.886868372, 0.877453634, 0.868845119, 0.859807201, 0.851539824, 0.84285655, 0.834348576, 0.826561323, 0.818377547, 0.810884228, 0.803006467, 0.795280298, 0.788202152, 0.780756917, 0.773933823, 0.766754474, 0.759707098, 0.753245434, 0.746443097, 0.74020417, 0.73363431],
            refractiveIndex: [1.000308003, 1.000303036, 1.00029911, 1.000295938, 1.000293329, 1.000291152, 1.000289313, 1.000287743, 1.000286391, 1.000285217, 1.000284191, 1.000283287, 1.000282488, 1.000281777, 1.000281141, 1.00028057, 1.000280056, 1.00027959, 1.000279168, 1.000278783, 1.000278432, 1.00027811, 1.000277814, 1.000277542, 1.000277291, 1.000277059, 1.000276844, 1.000276644, 1.000276458, 1.000276285, 1.000276123, 1.000275972, 1.000275831, 1.000275698, 1.000275573, 1.000275456, 1.000275346, 1.000275242, 1.000275144, 1.000275051, 1.000274964, 1.000274881, 1.000274802, 1.000274728, 1.000274657, 1.00027459, 1.000274526, 1.000274465, 1.000274407, 1.000274352, 1.000274299, 1.000274249, 1.0002742, 1.000274154, 1.000274111, 1.000274068, 1.000274027, 1.00027399, 1.000273951, 1.000273917, 1.000273882, 1.000273848, 1.000273818, 1.000273787, 1.000273759, 1.00027373, 1.000273702, 1.000273677, 1.000273651, 1.000273627, 1.000273603, 1.00027358, 1.000273559, 1.000273537, 1.000273518, 1.000273497, 1.000273478, 1.00027346, 1.000273442, 1.000273425, 1.000273408, 1.000273391, 1.000273376, 1.00027336, 1.000273346, 1.000273331, 1.000273317, 1.000273304, 1.00027329, 1.000273278, 1.000273265, 1.000273253, 1.000273242, 1.00027323, 1.000273219, 1.000273208, 1.000273197, 1.000273188, 1.000273177, 1.000273168, 1.000273158]
        };
        refractiveIndexData.waveNumberVacuumInverseCentimeters =  refractiveIndexData.wavelengthVacuumNanometers.map(wavelengthNanometers => 1 / (wavelengthNanometers * 1e-7));
        
        function interpolate(xList, yList, targetX, ) {
            // Input validation
            if (!Array.isArray(xList) || !Array.isArray(yList) || xList.length !== yList.length) {
                throw new Error('Invalid input: xList and yList must be arrays with the same length.');
            }

            // Check for ascending or descending order based on first and last elements
            const isDescending = xList[0] > xList[xList.length - 1];
            
            // Find the indices of the closest x values
            let lowerIndex = 0;
            let upperIndex = 0;
            if  (isDescending===true) {
                const index = xList.findIndex(x => x <= targetX);
                lowerIndex = index === -1 ? xList.length - 1 : Math.max(index - 1, 0);
                upperIndex = Math.min(index, xList.length - 1);
            } else {
                const index = xList.findIndex(x => x >= targetX);
                lowerIndex = index === -1 ? xList.length - 1 : Math.max(index - 1, 0);
                upperIndex = Math.min(index, xList.length - 1);
            }
            
            // Check if targetX is exactly equal to an existing x value
            if (xList[lowerIndex] === targetX) {
                return yList[lowerIndex];
            }
            
            // Check if we are at the edge. If so, we will do a linear extrapolation
            if ((lowerIndex === 0) && (upperIndex === 0)) {
                upperIndex = 1;
            }
            if ((lowerIndex === xList.length - 1) && (upperIndex === -1)) {
                upperIndex = lowerIndex;
                lowerIndex = upperIndex - 1;
            } 
            
            // Perform linear interpolation
            const lowerX = xList[lowerIndex];
            const lowerY = yList[lowerIndex];
            const upperX = xList[upperIndex];
            const upperY = yList[upperIndex];
            const slope = (upperY - lowerY) / (upperX - lowerX);
            const interpolatedY = lowerY + slope * (targetX - lowerX);

            return interpolatedY;
        }


        function showNSignificantDigits(number, n) {
            // Handle invalid input (non-numeric or negative n)
            if (isNaN(number)) {
                return NaN;
            }

            // Convert to a string for easier manipulation
            const numString = String(number);

            // Handle trailing zeros (special case for numbers ending in ".0", ".00", etc.)
            if (/\.0+$/.test(numString)) {
                const significantDigits = numString.replace(/\.?0+$/, "").length;
                const trailingZeros = numString.match(/0+$/)[0].length;
                const digitsToShow = Math.min(n, significantDigits);
                return numString.slice(0, digitsToShow);
            }

            return number.toPrecision(n);
        }

        function convertLine() {
            let value = parseFloat(document.getElementById("inputValue").value);
            let inputUnit = document.getElementById("inputUnit").value;
            let inputType = document.getElementById("inputType").value;
            let outputUnitWavelengthVacuum = document.getElementById("outputLineUnitWavelengthVacuum").value;
            let outputUnitWavelengthAir = document.getElementById("outputLineUnitWavelengthAir").value;
            let outputUnitFrequency = document.getElementById("outputLineUnitFrequency").value;
            let outputUnitEnergy = document.getElementById("outputLineUnitEnergy").value;
            let outputUnitWaveNumberVacuum = document.getElementById("outputLineUnitWaveNumberVacuum").value;


            let wavelengthVacuum, wavelengthAir, frequency, energy, waveNumberVacuum;


            switch (inputType) {
                case 'wavelength_vacuum':
                    wavelengthVacuum = convertToMeters(value, inputUnit);
                    n_air = interpolate(refractiveIndexData.wavelengthVacuumNanometers, refractiveIndexData.refractiveIndex, convertFromMeters(wavelengthVacuum, 'nm'));
                    wavelengthAir = wavelengthVacuum / n_air;
                    frequency = c / wavelengthVacuum;
                    energy = hc / wavelengthVacuum;
                    waveNumberVacuum = 1 / wavelengthVacuum;  // in inverse meters
                    break;
                case 'wavelength_air':
                    wavelengthAir = convertToMeters(value, inputUnit);
                    n_air = interpolate(refractiveIndexData.wavelengthAirNanometers, refractiveIndexData.refractiveIndex, convertFromMeters(wavelengthAir, 'nm'));
                    wavelengthVacuum = wavelengthAir * n_air;
                    frequency = c / wavelengthVacuum;
                    energy = hc / wavelengthVacuum;
                    waveNumberVacuum = 1 / wavelengthVacuum;  // in inverse meters
                    break;
                case 'frequency':
                    frequency = convertToHertz(value, inputUnit);
                    n_air = interpolate(refractiveIndexData.frequencyTeraHertz, refractiveIndexData.refractiveIndex, convertFromHertz(frequency, 'THz'));
                    wavelengthVacuum = c / frequency;
                    wavelengthAir = wavelengthVacuum / n_air;
                    energy = h * frequency;
                    waveNumberVacuum = 1 / wavelengthVacuum;  // in inverse meters
                    break;
                case 'energy':
                    energy = convertToEV(value, inputUnit);
                    n_air = interpolate(refractiveIndexData.energyElectronVolt, refractiveIndexData.refractiveIndex, convertFromEV(energy, 'eV'));
                    frequency = energy / h;
                    wavelengthVacuum = c / frequency;
                    wavelengthAir = wavelengthVacuum / n_air;
                    waveNumberVacuum = 1 / wavelengthVacuum;  // in inverse meters
                    break;
                case 'wave_number_vacuum':
                    waveNumberVacuum = convertToInverseMeters(value, inputUnit);
                    wavelengthVacuum = 1 / waveNumberVacuum;
                    n_air = interpolate(refractiveIndexData.wavelengthVacuumNanometers, refractiveIndexData.refractiveIndex, convertFromMeters(wavelengthVacuum, 'nm'));
                    wavelengthAir = wavelengthVacuum / n_air;
                    frequency = c / wavelengthVacuum;
                    energy = hc / wavelengthVacuum;
                    break;
            }
            
            const result_wavelength_vacuum = showNSignificantDigits(convertFromMeters(wavelengthVacuum, outputUnitWavelengthVacuum), displayedSignificantDigits);
            const result_wavelength_air = showNSignificantDigits(convertFromMeters(wavelengthAir, outputUnitWavelengthAir), displayedSignificantDigits);
            const result_frequency = showNSignificantDigits(convertFromHertz(frequency, outputUnitFrequency), displayedSignificantDigits);
            const result_energy = showNSignificantDigits(convertFromEV(energy, outputUnitEnergy), displayedSignificantDigits);
            const result_wave_number_vacuum = showNSignificantDigits(convertFromInverseMeters(waveNumberVacuum, outputUnitWaveNumberVacuum), displayedSignificantDigits);
            const result_refractive_index = showNSignificantDigits(n_air - 1, displayedSignificantDigits);

            document.getElementById("result-wavelength-vacuum").innerHTML = `${result_wavelength_vacuum}`;
            document.getElementById("result-wavelength-air").innerHTML = `${result_wavelength_air}`;
            document.getElementById("result-frequency").innerHTML = `${result_frequency}`;
            document.getElementById("result-energy").innerHTML = `${result_energy}`;
            document.getElementById("result-wave-number-vacuum").innerHTML = `${result_wave_number_vacuum}`;
            document.getElementById("result-refractive-index").innerHTML = `${result_refractive_index}`;
        }

        function get_five_values(value, inputType, inputUnit) {

            let wavelengthVacuum, wavelengthAir, frequency, energy, waveNumberVacuum;

            switch (inputType) {
                case 'wavelength_vacuum':
                    wavelengthVacuum = convertToMeters(value, inputUnit);
                    n_air = interpolate(refractiveIndexData.wavelengthVacuumNanometers, refractiveIndexData.refractiveIndex, convertFromMeters(wavelengthVacuum, 'nm'));
                    wavelengthAir = wavelengthVacuum / n_air;
                    frequency = c / wavelengthVacuum;
                    energy = hc / wavelengthVacuum;
                    waveNumberVacuum = 1 / wavelengthVacuum; // in inverse meters
                    break;
                case 'wavelength_air':
                    wavelengthAir = convertToMeters(value, inputUnit);
                    n_air = interpolate(refractiveIndexData.wavelengthAirNanometers, refractiveIndexData.refractiveIndex, convertFromMeters(wavelengthAir, 'nm'));
                    wavelengthVacuum = wavelengthAir * n_air;
                    frequency = c / wavelengthVacuum;
                    energy = hc / wavelengthVacuum;
                    waveNumberVacuum = 1 / wavelengthVacuum; // in inverse meters
                    break;
                case 'frequency':
                    frequency = convertToHertz(value, inputUnit);
                    n_air = interpolate(refractiveIndexData.frequencyTeraHertz, refractiveIndexData.refractiveIndex, convertFromHertz(frequency, 'THz'));
                    wavelengthVacuum = c / frequency;
                    wavelengthAir = wavelengthVacuum / n_air;
                    energy = h * frequency;
                    waveNumberVacuum = 1 / wavelengthVacuum; // in inverse meters
                    break;
                case 'energy':
                    energy = convertToEV(value, inputUnit);
                    n_air = interpolate(refractiveIndexData.energyElectronVolt, refractiveIndexData.refractiveIndex, convertFromEV(energy, 'eV'));
                    frequency = energy / h;
                    wavelengthVacuum = c / frequency;
                    wavelengthAir = wavelengthVacuum / n_air;
                    waveNumberVacuum = 1 / wavelengthVacuum; // in inverse meters
                    break;
                case 'wave_number_vacuum':
                    waveNumberVacuum = convertToInverseMeters(value, inputUnit);
                    wavelengthVacuum = 1 / waveNumberVacuum;
                    n_air = interpolate(refractiveIndexData.wavelengthVacuumNanometers, refractiveIndexData.refractiveIndex, convertFromMeters(wavelengthVacuum, 'nm'));
                    wavelengthAir = wavelengthVacuum / n_air;
                    frequency = c / wavelengthVacuum;
                    energy = hc / wavelengthVacuum;
                    break;
                
            }
            return [wavelengthVacuum, wavelengthAir, frequency, energy, waveNumberVacuum];
        }

        function get_min_center_max(inputMinCenterMaxValue, inputBandwidthValue, inputMinCenterMax) {
            let minValue, centerValue, maxValue;

            switch (inputMinCenterMax) {
                case 'min':
                    minValue = inputMinCenterMaxValue;
                    centerValue = inputMinCenterMaxValue + inputBandwidthValue/2;
                    maxValue = inputMinCenterMaxValue + inputBandwidthValue;
                    break;
                case 'center':
                    minValue = inputMinCenterMaxValue - inputBandwidthValue/2;
                    centerValue = inputMinCenterMaxValue;
                    maxValue = inputMinCenterMaxValue + inputBandwidthValue/2;
                    break;
                case 'max':
                    minValue = inputMinCenterMaxValue - inputBandwidthValue;
                    centerValue = inputMinCenterMaxValue - inputBandwidthValue/2;
                    maxValue = inputMinCenterMaxValue;
                    break;
            }
            return [minValue, centerValue, maxValue];
        }

        function convertBandwidth() {
            let inputBandwidthValue = parseFloat(document.getElementById("inputBandwidthValue").value);
            let inputBandwidthUnit = document.getElementById("inputBandwidthUnit").value;
            let inputBandwidthType = document.getElementById("inputBandwidthType").value;
            
            // let inputMinCenterMax = parseFloat(document.getElementById("inputMinCenterMax").value);
            let inputMinCenterMaxValue = parseFloat(document.getElementById("inputMinCenterMaxValue").value);
            let inputMinCenterMaxUnit = document.getElementById("inputMinCenterMaxUnit").value;
            let inputMinCenterMaxType = document.getElementById("inputMinCenterMaxType").value;

            let outputUnitWavelengthVacuum = document.getElementById("outputBandwidthUnitWavelengthVacuum").value;
            let outputUnitWavelengthAir = document.getElementById("outputBandwidthUnitWavelengthAir").value;
            let outputUnitFrequency = document.getElementById("outputBandwidthUnitFrequency").value;
            let outputUnitEnergy = document.getElementById("outputBandwidthUnitEnergy").value;
            let outputUnitWaveNumberVacuum = document.getElementById("outputBandwidthUnitWaveNumberVacuum").value;

            let [wavelengthVacuum, wavelengthAir, frequency, energy, waveNumberVacuum] = get_five_values(inputMinCenterMaxValue, inputMinCenterMaxType, inputMinCenterMaxUnit);

            let wavelengthVacuumMin, wavelengthAirMin, frequencyMin, energyMin, waveNumberVacuumMin;
            let wavelengthVacuumCenter, wavelengthAirCenter, frequencyCenter, energyCenter, waveNumberVacuumCenter;
            let wavelengthVacuumMax, wavelengthAirMax, frequencyMax, energyMax, waveNumberVacuumMax;
            let bandwidth, minValue, centerValue, maxValue, initialValue;
            let wavelengthVacuumBandwidth, wavelengthAirBandwidth, frequencyBandwidth, energyBandwidth, waveNumberVacuumBandwidth;

            initialValue = {
                wavelength_vacuum : wavelengthVacuum,
                wavelength_air : wavelengthAir,
                frequency : frequency,
                energy : energy, 
                wave_number_vacuum : waveNumberVacuum, 
            };
            
            const conversionMethods = {
                wavelength_vacuum : convertToMeters,
                wavelength_air : convertToMeters,
                frequency : convertToHertz,
                energy : convertToEV, 
                wave_number_vacuum : convertToInverseMeters,
            };

            const baseUnits = {
                wavelength_vacuum : 'm',
                wavelength_air : 'm',
                frequency : 'Hz',
                energy : 'eV', 
                wave_number_vacuum : '1/m',
            };
            const conversionMethod = conversionMethods[inputBandwidthType];
            const baseUnit = baseUnits[inputBandwidthType];


            bandwidth = conversionMethods[inputBandwidthType](inputBandwidthValue, inputBandwidthUnit);
            [minValue, centerValue, maxValue] = get_min_center_max(initialValue[inputBandwidthType], bandwidth, 'center');
            [wavelengthVacuumMin, wavelengthAirMin, frequencyMin, energyMin, waveNumberVacuumMin] = get_five_values(minValue, inputBandwidthType, baseUnit);
            [wavelengthVacuumCenter, wavelengthAirCenter, frequencyCenter, energyCenter, waveNumberVacuumCenter] = get_five_values(centerValue, inputBandwidthType, baseUnit);
            [wavelengthVacuumMax, wavelengthAirMax, frequencyMax, energyMax, waveNumberVacuumMax] = get_five_values(maxValue, inputBandwidthType, baseUnit);

            n_air = interpolate(refractiveIndexData.wavelengthVacuumNanometers, refractiveIndexData.refractiveIndex, convertFromMeters(wavelengthVacuumCenter, 'nm'));
            n_air_min = interpolate(refractiveIndexData.wavelengthVacuumNanometers, refractiveIndexData.refractiveIndex, convertFromMeters(wavelengthVacuumMin, 'nm'));
            n_air_max = interpolate(refractiveIndexData.wavelengthVacuumNanometers, refractiveIndexData.refractiveIndex, convertFromMeters(wavelengthVacuumMax, 'nm'));
            
            wavelengthVacuumBandwidth = Math.abs(wavelengthVacuumMax - wavelengthVacuumMin);
            wavelengthAirBandwidth = Math.abs(wavelengthAirMax - wavelengthAirMin);
            frequencyBandwidth = Math.abs(frequencyMax - frequencyMin);
            energyBandwidth = Math.abs(energyMax - energyMin);
            waveNumberVacuumBandwidth = Math.abs(waveNumberVacuumMax - waveNumberVacuumMin);
            deltaNAir = Math.abs(n_air_min - n_air_max);

            const result_wavelength_vacuum = showNSignificantDigits(convertFromMeters(wavelengthVacuumBandwidth, outputUnitWavelengthVacuum), displayedSignificantDigits);
            const result_wavelength_air = showNSignificantDigits(convertFromMeters(wavelengthAirBandwidth, outputUnitWavelengthAir), displayedSignificantDigits);
            const result_frequency = showNSignificantDigits(convertFromHertz(frequencyBandwidth, outputUnitFrequency), displayedSignificantDigits);
            const result_energy = showNSignificantDigits(convertFromEV(energyBandwidth, outputUnitEnergy), displayedSignificantDigits);
            const result_wave_number_vacuum = showNSignificantDigits(convertFromInverseMeters(waveNumberVacuumBandwidth, outputUnitWaveNumberVacuum), displayedSignificantDigits);
            const result_refractive_index = showNSignificantDigits(deltaNAir, displayedSignificantDigits);

            document.getElementById("result-bandwidth-wavelength-vacuum").innerHTML = `${result_wavelength_vacuum}`;
            document.getElementById("result-bandwidth-wavelength-air").innerHTML = `${result_wavelength_air}`;
            document.getElementById("result-bandwidth-frequency").innerHTML = `${result_frequency}`;
            document.getElementById("result-bandwidth-energy").innerHTML = `${result_energy}`;
            document.getElementById("result-bandwidth-wave-number-vacuum").innerHTML = `${result_wave_number_vacuum}`;
            document.getElementById("result-bandwidth-refractive-index").innerHTML = `${result_refractive_index}`;
        }

        function convertToMeters(value, unit) {
            const units = {
                'pm': 1e-12,
                'nm': 1e-9,
                'um': 1e-6,
                'μm': 1e-6,
                'mm': 1e-3,
                'cm': 1e-2,
                'm': 1
            };
            return value * units[unit];
        }

        function convertFromMeters(value, unit) {
            const units = {
                'pm': 1e12,
                'nm': 1e9,
                'um': 1e6,
                'μm': 1e6,
                'mm': 1e3,
                'cm': 1e2,
                'm': 1
            };
            return value * units[unit];
        }

        function convertToInverseMeters(value, unit) {
            const units = {
                '1/pm': 1e12,
                '1/nm': 1e9,
                '1/um': 1e6,
                '1/μm': 1e6,
                '1/mm': 1e3,
                '1/cm': 1e2,
                '1/m': 1
            };
            return value * units[unit];
        }

        function convertFromInverseMeters(value, unit) {
            const units = {
                '1/pm': 1e-12,
                '1/nm': 1e-9,
                '1/um': 1e-6,
                '1/μm': 1e-6,
                '1/mm': 1e-3,
                '1/cm': 1e-2,
                '1/m': 1
            };
            return value * units[unit];
        }

        function convertToHertz(value, unit) {
            const units = {
                'Hz': 1,
                'kHz': 1e3,
                'MHz': 1e6,
                'GHz': 1e9,
                'THz': 1e12
            };
            return value * units[unit];
        }

        function convertFromHertz(value, unit) {
            const units = {
                'Hz': 1,
                'kHz': 1e-3,
                'MHz': 1e-6,
                'GHz': 1e-9,
                'THz': 1e-12
            };
            return value * units[unit];
        }

        function convertToEV(value, unit) {
            const units = {
                'eV': 1,
                'meV': 1e-3,
                'ueV': 1e-6,
                'μeV': 1e-6,
                'neV': 1e-9
            };
            return value * units[unit];
        }

        function convertFromEV(value, unit) {
            const units = {
                'eV': 1,
                'meV': 1e3,
                'ueV': 1e6,
                'μeV': 1e6,
                'neV': 1e9
            };
            return value * units[unit];
        }

        function updateLineInputUnits() {
            let inputType = document.getElementById("inputType").value;
            let unitSelect = document.getElementById("inputUnit");
            unitSelect.innerHTML = "";
            let units, default_index;
            switch (inputType) {
                case 'wavelength_vacuum':
                case 'wavelength_air':
                    units = ['pm', 'nm', 'μm', 'mm', 'cm', 'm'];
                    default_index = 1;
                    break;
                case 'frequency':
                    units = ['Hz', 'kHz', 'MHz', 'GHz', 'THz'];
                    default_index = 4;
                    break;
                case 'energy':
                    units = ['neV', 'μeV', 'meV', 'eV'];
                    default_index = 3;
                    break;
                case 'wave_number_vacuum':
                    units = ['1/pm', '1/nm', '1/μm', '1/mm', '1/cm', '1/m'];
                    default_index = 4;
                    break;

            }
            for (let unit of units) {
                let option = document.createElement("option");
                option.value = unit;
                option.text = unit;
                unitSelect.add(option);
            }
            unitSelect.selectedIndex  = default_index;
        }

        document.addEventListener("DOMContentLoaded", function () {
            updateLineInputUnits();
            document.getElementById("inputType").addEventListener("change", updateLineInputUnits);
        });

        function updateInputBandwidthUnits() {
            let inputType = document.getElementById("inputBandwidthType").value;
            let unitSelect = document.getElementById("inputBandwidthUnit");
            unitSelect.innerHTML = "";
            let units, default_index;
            switch (inputType) {
                case 'wavelength_vacuum':
                case 'wavelength_air':
                    units = ['pm', 'nm', 'μm', 'mm', 'cm', 'm'];
                    default_index = 0;
                    break;
                case 'frequency':
                    units = ['Hz', 'kHz', 'MHz', 'GHz', 'THz'];
                    default_index = 2;
                    break;
                case 'energy':
                    units = ['neV', 'μeV', 'meV', 'eV'];
                    default_index = 1;
                    break;
                case 'wave_number_vacuum':
                    units = ['1/pm', '1/nm', '1/μm', '1/mm', '1/cm', '1/m'];
                    default_index = 5;
                    break;
            }
            for (let unit of units) {
                let option = document.createElement("option");
                option.value = unit;
                option.text = unit;
                unitSelect.add(option);
            }
            unitSelect.selectedIndex  = default_index;
        }

        document.addEventListener("DOMContentLoaded", function () {
            updateInputBandwidthUnits();
            document.getElementById("inputBandwidthType").addEventListener("change", updateInputBandwidthUnits);
        });

        function updateInputMinCenterMaxUnits() {
            let inputType = document.getElementById("inputMinCenterMaxType").value;
            let unitSelect = document.getElementById("inputMinCenterMaxUnit");
            unitSelect.innerHTML = "";
            let units, default_index;
            switch (inputType) {
                case 'wavelength_vacuum':
                case 'wavelength_air':
                    units = ['pm', 'nm', 'μm', 'mm', 'cm', 'm'];
                    default_index = 1;
                    break;
                case 'frequency':
                    units = ['Hz', 'kHz', 'MHz', 'GHz', 'THz'];
                    default_index = 4;
                    break;
                case 'energy':
                    units = ['neV', 'μeV', 'meV', 'eV'];
                    default_index = 3;
                    break;
                case 'wave_number_vacuum':
                    units = ['1/pm', '1/nm', '1/μm', '1/mm', '1/cm', '1/m'];
                    default_index = 4;
                    break;
            }
            for (let unit of units) {
                let option = document.createElement("option");
                option.value = unit;
                option.text = unit;
                unitSelect.add(option);
            }
            unitSelect.selectedIndex  = default_index;
        }

        document.addEventListener("DOMContentLoaded", function () {
            updateInputMinCenterMaxUnits();
            document.getElementById("inputMinCenterMaxType").addEventListener("change", updateInputMinCenterMaxUnits);
        });
    </script>
</head>
<body>
    <h1>Photon Property Converter</h1>
    <div class="container">
        <h2>Line Conversion</h2>
        <div>
            <select id="inputType">
                <option value="wavelength_vacuum">Wavelength (Vacuum)</option>
                <option value="wavelength_air" selected>Wavelength (Air)</option>
                <option value="frequency">Frequency</option>
                <option value="energy">Energy</option>
                <option value="wave_number_vacuum">Wave Number (Vacuum)</option>
            </select>
            <input type="number" id="inputValue" placeholder="Enter value">
            <select id="inputUnit"></select>
            <button onclick="convertLine()">Convert</button>
        </div>
        <div>
            <label for="outputLineUnitWavelengthVacuum">Wavelength (Vacuum):</label>
            <span id="result-wavelength-vacuum"></span>
            <select id="outputLineUnitWavelengthVacuum" onchange="convertLine()">
                <option value="pm">pm</option>
                <option value="nm" selected>nm</option>
                <option value="um">µm</option>
                <option value="mm">mm</option>
                <option value="cm">cm</option>
                <option value="m">m</option>
            </select>
        </div>
        <div>
            <label for="outputLineUnitWavelengthAir">Wavelength (Air):</label>
            <span id="result-wavelength-air"></span>
            <select id="outputLineUnitWavelengthAir" onchange="convertLine()">
                <option value="pm">pm</option>
                <option value="nm" selected>nm</option>
                <option value="um">µm</option>
                <option value="mm">mm</option>
                <option value="cm">cm</option>
                <option value="m">m</option>
            </select>
        </div>
        <div>
            <label for="outputLineUnitFrequency">Frequency:</label>
            <span id="result-frequency"></span>
            <select id="outputLineUnitFrequency" onchange="convertLine()">
                <option value="kHz">kHz</option>
                <option value="MHz">MHz</option>
                <option value="GHz">GHz</option>
                <option value="THz" selected>THz</option>
            </select>
        </div>
        <div>
            <label for="outputLineUnitEnergy">Energy:</label>
            <span id="result-energy"></span>
            <select id="outputLineUnitEnergy" onchange="convertLine()">
                <option value="neV">neV</option>
                <option value="ueV">μeV</option>
                <option value="meV">meV</option>
                <option value="eV" selected>eV</option>
            </select>
        </div>
        <div>
            <label for="outputLineUnitWaveNumberVacuum">Wave Number (Vacuum):</label>
            <span id="result-wave-number-vacuum"></span>
            <select id="outputLineUnitWaveNumberVacuum" onchange="convertLine()">
                <option value="1/m">1/m</option>
                <option value="1/cm" selected>1/cm</option>
                <option value="1/mm">1/mm</option>
                <option value="1/um">1/µm</option>
                <option value="1/nm">1/nm</option>
                <option value="1/pm">1/pm</option>
            </select>
        </div>
        <div>
            <label>Refractive Index - 1:</label>
            <span id="result-refractive-index"></span>
        </div>
    </div>
    <div class="container">
        <h2>Bandwidth Conversion</h2>
        <div>
            <label>Bandwidth:</label>
            <div>
                <select id="inputBandwidthType">
                    <option value="wavelength_vacuum">Wavelength (Vacuum)</option>
                    <option value="wavelength_air" selected>Wavelength (Air)</option>
                    <option value="frequency">Frequency</option>
                    <option value="energy">Energy</option>
                    <option value="wave_number_vacuum">Wave Number (Vacuum)</option>
                </select>
                <input type="number" id="inputBandwidthValue" placeholder="Enter value">
                <select id="inputBandwidthUnit"></select>
                <button onclick="convertBandwidth()">Convert</button>
            </div>    
        </div>
        <div>
            <!-- <select id="inputMinCenterMax">
                <option value="min">Minimum</option>
                <option value="center" selected>Center</option>
                <option value="max">Maximum</option>
            </select> -->
            <label>Center:</label>
            <div>
                <select id="inputMinCenterMaxType">
                    <option value="wavelength_vacuum">Wavelength (Vacuum)</option>
                    <option value="wavelength_air" selected>Wavelength (Air)</option>
                    <option value="frequency">Frequency</option>
                    <option value="energy">Energy</option>
                    <option value="wave_number_vacuum">Wave Number (Vacuum)</option>

                </select>
                <input type="number" id="inputMinCenterMaxValue" placeholder="Enter value">
                <select id="inputMinCenterMaxUnit"></select>
            </div>    
        </div>
        <div>
            <label for="outputBandwidthUnitWavelengthVacuum">Wavelength (Vacuum):</label>
            <span id="result-bandwidth-wavelength-vacuum"></span>
            <select id="outputBandwidthUnitWavelengthVacuum" onchange="convertBandwidth()">
                <option value="pm" selected>pm</option>
                <option value="nm">nm</option>
                <option value="um">µm</option>
                <option value="mm">mm</option>
                <option value="cm">cm</option>
                <option value="m">m</option>

            </select>
        </div>
        <div>
            <label for="outputBandwidthUnitWavelengthAir">Wavelength (Air):</label>
            <span id="result-bandwidth-wavelength-air"></span>
            <select id="outputBandwidthUnitWavelengthAir" onchange="convertBandwidth()">
                <option value="pm" selected>pm</option>
                <option value="nm">nm</option>
                <option value="um">µm</option>
                <option value="mm">mm</option>
                <option value="cm">cm</option>
                <option value="m">m</option>
            </select>
        </div>
        <div>
            <label for="outputBandwidthUnitFrequency">Frequency:</label>
            <span id="result-bandwidth-frequency"></span>
            <select id="outputBandwidthUnitFrequency" onchange="convertBandwidth()">
                <option value="kHz">kHz</option>
                <option value="MHz" selected>MHz</option>
                <option value="GHz">GHz</option>
                <option value="THz">THz</option>
            </select>
        </div>
        <div>
            <label for="outputBandwidthUnitEnergy">Energy:</label>
            <span id="result-bandwidth-energy"></span>
            <select id="outputBandwidthUnitEnergy" onchange="convertBandwidth()">
                <option value="neV">neV</option>
                <option value="ueV" selected>μeV</option>
                <option value="meV">meV</option>
                <option value="eV">eV</option>
            </select>
        </div>
        <div>
            <label for="outputBandwidthUnitWaveNumberVacuum">Wave Number (Vacuum):</label>
            <span id="result-bandwidth-wave-number-vacuum"></span>
            <select id="outputBandwidthUnitWaveNumberVacuum" onchange="convertBandwidth()">
                <option value="1/m" selected>1/m</option>
                <option value="1/cm">1/cm</option>
                <option value="1/mm">1/mm</option>
                <option value="1/um">1/µm</option>
                <option value="1/nm">1/nm</option>
                <option value="1/pm">1/pm</option>
            </select>
        </div>
        <div>
            <label>Refractive Index:</label>
            <span id="result-bandwidth-refractive-index"></span>
        </div>
    </div>
</body>
</html>
